{% extends "base.html" %}
{% block content %}
<strong>{{ msg }}</strong>

<p>{{ auctioneer.end_time|date:'Y-m-d'}}{{ auctioneer.end_time|time:"H:i" }}</p>

<img src="{{ auctioneer.image.url }}">

<h2>{{ auctioneer.title }}</h2>
<h4>{{ auctioneer.description }}</h4>
    <p>hello</p>
<font size="2"><p><b>Base price: {{ auctioneer.base_price }}</b></p>
    <p>{{ auctioneer.end_time}}</p>
    <p><b>Seller Name: {{ auctioneer.seller.username }}</b></p>
    <p><b>Status: {{ auctioneer.status }}</b></p>
</font>


{% if bb %}
<p id="demo"></p>
<p id="message"></p>
{% for b in bb %}<FONT COLOR="#000EE9"><h4>Bid amount {{ b.amount }}, Bidder: {{ b.user }}, Bid Time: {{ b.bid_time }}</h4></FONT>{% endfor %}
{% endif %}


<div style="text-align: left;">
    <h3></h3>
    <form action="/bidauction/{{ auctioneer.id }}/" method="POST">
        {% csrf_token %}
        <input type="search" title='am' id='am' name='am' placeholder="amount">
        <input type="submit" value="Bid">

    </form>

</div>

<script>
    {#var time = document.getElementById('endtime1').value;#}
    var endtime = document.getElementById("endtime").innerText;
// Set the date we're counting down to
// Set the date we're counting down to
var countDownDate = new Date(endtime).getTime();
// Update the count down every 1 second
var x = setInterval(function() {

    // Get todays date and time
    var now = new Date().getTime();

    // Find the distance between now and the count down date
    var distance = countDownDate - now;

    // Time calculations for days, hours, minutes and seconds
    var days = Math.floor(distance / (1000 * 60 * 60 * 24));
    var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
    var seconds = Math.floor((distance % (1000 * 60)) / 1000);

    // Output the result in an element with id="demo"
    document.getElementById("demo").innerHTML = days + "d " + hours + "h "
    + minutes + "m " + seconds + "s ";

    // If the count down is over, write some text
    if (distance < 0) {
        clearInterval(x);
        document.getElementById("demo").innerHTML = "ITEM EXPIRED";
    }
}, 1000);

</script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>

<script>

       setInterval(receive, 10000);
       function receive() {
           $.get('api/bidlist/', function (data) {
       if (data.length !== 0)
       {    console.log(data)
            var node = document.createElement("span");
           for(var i=0;i<data.length;i++)
           {
               if(data[i]['auctioneer'] == {{auctioneer.id}})
               {
                   console.log(data[i].user);
                   var textnode = document.createTextNode(data[i].user +":" +data[i].amount);
                   node.appendChild(textnode);
               }

           }
           var e = document.getElementById("message").appendChild(node);



       }
   })
}

</script>
{% endblock %}

